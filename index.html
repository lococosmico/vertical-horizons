<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertical Horizons - École d'Escalade</title>
    
    <!-- CSS primero para evitar FOUC -->
    <style>
        /* Preloader invisible pero interactivo */
        body.preload {
            visibility: hidden;
            opacity: 0;
            height: 100vh;
            overflow: hidden;
        }
        body.loaded {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.4s ease-out;
        }
        
        /* Selector de idioma */
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 8px;
        }
        .language-switcher button {
            background: rgba(0,0,0,0.3);
            border: 1px solid white;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
    </style>
    
    <!-- CSS principal con preload -->
    <link rel="preload" href="styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="styles.css"></noscript>
</head>

<body class="preload">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertical Horizons - École d'Escalade</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Prevenir FOUC (Flash of Unstyled Content) */
        body { 
            visibility: hidden; 
            opacity: 0; 
            transition: opacity 0.3s ease; 
        }
        body.ready { 
            visibility: visible; 
            opacity: 1; 
        }
        
        /* Selector de idioma */
        .language-switcher { 
            position: absolute; 
            top: 20px; 
            right: 20px; 
            z-index: 1000; /* Asegura que esté por encima de otros elementos */
        }
        .language-switcher button { 
            background: rgba(255,255,255,0.2); 
            border: 1px solid rgba(255,255,255,0.3);
            color: white; 
            padding: 5px 10px; 
            margin: 0 2px; 
            cursor: pointer; 
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        .language-switcher button:hover {
            background: rgba(255,255,255,0.3);
        }
    </style>
</head>
<body>
    <header>
        <h1>Vertical Horizons</h1>
        <div class="language-switcher">
            <button onclick="changeLanguage('fr')">FR</button>
            <button onclick="changeLanguage('en')">EN</button>
        </div>
        <nav>
            <ul>
                <li><a href="#about" data-i18n="about">À propos</a></li>
                <li><a href="#gallery" data-i18n="gallery">Galerie</a></li>
                <li><a href="#contact" data-i18n="contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Resto de tu contenido (secciones about, gallery, contact) -->

    <script>
    // Traducciones mejoradas con verificación de existencia
    const translations = {
        fr: {
            about: "À propos",
            gallery: "Galerie",
            contact: "Contact",
            about_title: "À propos",
            about_text: "Bienvenue chez Vertical Horizons, votre école d'escalade en Suisse. Nous proposons des cours pour tous les âges et niveaux.",
            gallery_title: "Galerie",
            contact_title: "Contact",
            name_placeholder: "Nom",
            email_placeholder: "Adresse e-mail",
            message_placeholder: "Message",
            submit_button: "Envoyer",
            copyright: "&copy; 2025 Vertical Horizons. Tous droits réservés."
        },
        en: {
            about: "About",
            gallery: "Gallery",
            contact: "Contact",
            about_title: "About Us",
            about_text: "Welcome to Vertical Horizons, your climbing school in Switzerland. We offer courses for all ages and skill levels.",
            gallery_title: "Gallery",
            contact_title: "Contact Us",
            name_placeholder: "Name",
            email_placeholder: "Email address",
            message_placeholder: "Message",
            submit_button: "Send",
            copyright: "&copy; 2025 Vertical Horizons. All rights reserved."
        }
    };

    // Función más robusta con manejo de errores
    function changeLanguage(lang) {
        try {
            if (!translations[lang]) return;
            
            document.documentElement.lang = lang;
            
            // Actualizar textos
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            
            // Actualizar placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });
            
            localStorage.setItem('preferredLang', lang);
            
        } catch (error) {
            console.error("Error changing language:", error);
        }
    }

    // Inicialización mejorada
    document.addEventListener('DOMContentLoaded', () => {
        const savedLang = localStorage.getItem('preferredLang');
        const browserLang = navigator.language.startsWith('en') ? 'en' : 'fr';
        const defaultLang = savedLang || browserLang;
        
        changeLanguage(defaultLang);
        document.body.classList.add('ready');
    });
    </script>
</body>
</html>
<script>
    // Mini loader para CSS
    function loadCSS(url) {
        return new Promise(resolve => {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = url;
            link.onload = resolve;
            document.head.appendChild(link);
        });
    }

    // Esperar a que todo esté listo
    Promise.all([
        loadCSS('styles.css'),
        new Promise(resolve => window.addEventListener('DOMContentLoaded', resolve))
    ]).then(() => {
        document.body.classList.replace('preload', 'loaded');
        
        // Tu código de traducciones aquí
        const translations = {
            fr: { /* ... tus traducciones al francés ... */ },
            en: { /* ... tus traducciones al inglés ... */ }
        };

        function changeLanguage(lang) {
            // ... tu implementación actual ...
        }

        // Inicialización
        const savedLang = localStorage.getItem('preferredLang') || 
                         (navigator.language.startsWith('en') ? 'en' : 'fr');
        changeLanguage(savedLang);
    }).catch(error => {
        console.error('Error durante la carga:', error);
        document.body.classList.replace('preload', 'loaded');
    });
    </script>
</body>
</html>

